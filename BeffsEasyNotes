'All code listed here is very important to copy carefully, if no caution is taken it will cause errors to which you can't add buttons in the designer view.  
'some of the comments are from source code snippets via microsoft or other supporting sites. You will need to add open file dialog and other misc items for this to work properly.

Imports System.IO

Public Class BeffsEasyNotes

    Private Sub NewToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles NewToolStripMenuItem.Click
        'Check if there's text added to the textbox
        If TextBox1.Modified Then
            'If the text of notepad changed, the program will ask the user if they want to save the changes
            Dim ask As MsgBoxResult
            ask = MsgBox("Do you want to save the changes", MsgBoxStyle.YesNoCancel, "New Document")
            If ask = MsgBoxResult.No Then
                TextBox1.Clear()
            ElseIf ask = MsgBoxResult.Cancel Then
            ElseIf ask = MsgBoxResult.Yes Then
                SaveFileDialog1.ShowDialog()
                My.Computer.FileSystem.WriteAllText(SaveFileDialog1.FileName, TextBox1.Text, False)
                TextBox1.Clear()
            End If
            'If textbox's text is still the same, notepad will open a new page:
        Else
            TextBox1.Clear()
        End If
    End Sub

    Private Sub OpenToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles OpenToolStripMenuItem.Click
        'Check if there's text added to the textbox
        If TextBox1.Modified Then
            'If the text of notepad changed, the program will ask the user if they want to save the changes
            Dim ask As MsgBoxResult
            ask = MsgBox("Do you want to save the changes", MsgBoxStyle.YesNoCancel, "Open Document")
            If ask = MsgBoxResult.No Then
                OpenFileDialog1.ShowDialog()
                TextBox1.Text = My.Computer.FileSystem.ReadAllText(OpenFileDialog1.FileName)
            ElseIf ask = MsgBoxResult.Cancel Then
            ElseIf ask = MsgBoxResult.Yes Then
                SaveFileDialog1.ShowDialog()
                My.Computer.FileSystem.WriteAllText(SaveFileDialog1.FileName, TextBox1.Text, False)
                TextBox1.Clear()
            End If
        Else
            'If textbox's text is still the same, notepad will show the OpenFileDialog
            OpenFileDialog1.ShowDialog()
            Try
                TextBox1.Text = My.Computer.FileSystem.ReadAllText(OpenFileDialog1.FileName)
            Catch ex As Exception
            End Try
        End If
    End Sub

    Private Sub SaveToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles SaveToolStripMenuItem.Click
        ' Create a SaveFileDialog to request a path and file name to save to.
        Dim saveFile1 As New SaveFileDialog()

        ' Initialize the SaveFileDialog to specify the RTF extension for the file.
        saveFile1.DefaultExt = "*.rtf"
        saveFile1.Filter = "RTF Files|*.rtf"

        ' Determine if the user selected a file name from the saveFileDialog.
        If (saveFile1.ShowDialog() = System.Windows.Forms.DialogResult.OK) _
            And (saveFile1.FileName.Length) > 0 Then

            ' Save the contents of the RichTextBox into the file.
            TextBox1.SaveFile(saveFile1.FileName, _
                RichTextBoxStreamType.PlainText)
        End If
    End Sub

    Private Sub UndoToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles UndoToolStripMenuItem.Click
        'check if textbox can undo
        If TextBox1.CanUndo Then
            TextBox1.Undo()
        Else
        End If
    End Sub

    Private Sub RedoToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles RedoToolStripMenuItem.Click
        'check if textbox can undo
        If TextBox1.CanRedo Then
            TextBox1.Redo()
        Else
        End If
    End Sub

    Private Sub CutToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles CutToolStripMenuItem.Click
        My.Computer.Clipboard.Clear()
        If TextBox1.SelectionLength > 0 Then
            My.Computer.Clipboard.SetText(TextBox1.SelectedText)

        End If
        TextBox1.SelectedText = ""
    End Sub

    Private Sub CopyToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles CopyToolStripMenuItem.Click
        My.Computer.Clipboard.Clear()
        If TextBox1.SelectionLength > 0 Then
        Else
            My.Computer.Clipboard.SetText(TextBox1.SelectedText)
        End If
    End Sub

    Private Sub PasteToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles PasteToolStripMenuItem.Click
        If My.Computer.Clipboard.ContainsText Then
            TextBox1.Paste()
        End If
    End Sub

    Private Sub SelectAllToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles SelectAllToolStripMenuItem.Click
        TextBox1.SelectAll()
    End Sub

    Private Sub SearchToolStripMenuItem1_Click(sender As Object, e As EventArgs) Handles SearchToolStripMenuItem1.Click
        Dim a As String
        Dim b As String
        a = InputBox("Enter text to be found")
        b = InStr(TextBox1.Text, a)
        If b Then
            TextBox1.Focus()
            TextBox1.SelectionStart = b - 1
            TextBox1.SelectionLength = Len(a)
        Else
            MsgBox("Text not found.")
        End If
    End Sub






    Private Sub LeftToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles LeftToolStripMenuItem.Click
        TextBox1.SelectionAlignment = HorizontalAlignment.Left
        LeftToolStripMenuItem.Checked = True
        CenterToolStripMenuItem.Checked = False
        RightToolStripMenuItem.Checked = False
    End Sub

    Private Sub CenterToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles CenterToolStripMenuItem.Click
        TextBox1.SelectionAlignment = HorizontalAlignment.Center
        LeftToolStripMenuItem.Checked = False
        CenterToolStripMenuItem.Checked = True
        RightToolStripMenuItem.Checked = False

    End Sub

    Private Sub RightToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles RightToolStripMenuItem.Click
        TextBox1.SelectionAlignment = HorizontalAlignment.Right
        LeftToolStripMenuItem.Checked = False
        CenterToolStripMenuItem.Checked = True
        RightToolStripMenuItem.Checked = False

    End Sub

    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
      
        'calling the below function to start the context ment (when the user right click the richtextbox
        InitializeMyContextMenu()
    End Sub

    Private Sub InitializeMyContextMenu()
        ' Create the contextMenu and the MenuItem to add.
        Dim contextMenu1 As New ContextMenu()
        Dim menuItem1 As New MenuItem("C&ut")
        AddHandler menuItem1.Click, AddressOf CutToolStripButton_Click
        Dim menuItem2 As New MenuItem("&Copy")
        AddHandler menuItem2.Click, AddressOf CopyToolStripButton_Click
        Dim menuItem3 As New MenuItem("&Paste")
        AddHandler menuItem3.Click, AddressOf PasteToolStripButton_Click
        ' Use the MenuItems property to call the Add method
        ' to add the MenuItem to the MainMenu menu item collection.
        contextMenu1.MenuItems.Add(menuItem1)
        contextMenu1.MenuItems.Add(menuItem2)
        contextMenu1.MenuItems.Add(menuItem3)
        ' Assign mainMenu1 to the rich text box.
        TextBox1.ContextMenu = contextMenu1
    End Sub
   







    Private Sub IncreaseToolStripMenuItem1_Click(sender As Object, e As EventArgs) Handles IncreaseToolStripMenuItem1.Click
        Try
            TextBox1.SelectionFont = New Font(TextBox1.SelectionFont.FontFamily, Int(TextBox1.SelectionFont.SizeInPoints + 5))
        Catch ex As Exception
        End Try
        TextBox1.Focus()
    End Sub

    Private Sub DecreaseToolStripMenuItem1_Click(sender As Object, e As EventArgs) Handles DecreaseToolStripMenuItem1.Click
        Try
            TextBox1.SelectionFont = New Font(TextBox1.SelectionFont.FontFamily, Int(TextBox1.SelectionFont.SizeInPoints - 5))
        Catch ex As Exception
        End Try
        TextBox1.Focus()

    End Sub

    Private Sub ToolStripButton1_Click(sender As Object, e As EventArgs) Handles ToolStripButton1.Click
        If TextBox1.SelectionFont.Bold = True Then
            If TextBox1.SelectionFont.Italic = True Then
                TextBox1.SelectionFont = New Font(Me.TextBox1.SelectionFont, FontStyle.Regular + FontStyle.Italic)
            Else
                TextBox1.SelectionFont = New Font(Me.TextBox1.SelectionFont, FontStyle.Regular)
            End If

        ElseIf TextBox1.SelectionFont.Bold = False Then
            If TextBox1.SelectionFont.Italic = True Then
                TextBox1.SelectionFont = New Font(Me.TextBox1.SelectionFont, FontStyle.Bold + FontStyle.Italic)
            Else
                TextBox1.SelectionFont = New Font(Me.TextBox1.SelectionFont, FontStyle.Bold)
            End If
        End If
        TextBox1.Focus()
    End Sub

    Private Sub ToolStripButton2_Click(sender As Object, e As EventArgs) Handles ToolStripButton2.Click
        If TextBox1.SelectionFont.Italic = True Then
            If TextBox1.SelectionFont.Bold = True Then
                TextBox1.SelectionFont = New Font(Me.TextBox1.SelectionFont, FontStyle.Regular + FontStyle.Bold)
            Else
                TextBox1.SelectionFont = New Font(Me.TextBox1.SelectionFont, FontStyle.Regular)
            End If

        ElseIf TextBox1.SelectionFont.Italic = False Then
            If TextBox1.SelectionFont.Bold = True Then
                TextBox1.SelectionFont = New Font(Me.TextBox1.SelectionFont, FontStyle.Italic + FontStyle.Bold)
            Else
                TextBox1.SelectionFont = New Font(Me.TextBox1.SelectionFont, FontStyle.Italic)
            End If
        End If
        TextBox1.Focus()
    End Sub

    Private Sub NewToolStripButton_Click(sender As Object, e As EventArgs) Handles NewToolStripButton.Click
        'Check if there's text added to the textbox
        If TextBox1.Modified Then
            'If the text of notepad changed, the program will ask the user if they want to save the changes
            Dim ask As MsgBoxResult
            ask = MsgBox("Do you want to save the changes", MsgBoxStyle.YesNoCancel, "New Document")
            If ask = MsgBoxResult.No Then
                TextBox1.Clear()
            ElseIf ask = MsgBoxResult.Cancel Then
            ElseIf ask = MsgBoxResult.Yes Then
                SaveFileDialog1.ShowDialog()
                My.Computer.FileSystem.WriteAllText(SaveFileDialog1.FileName, TextBox1.Text, False)
                TextBox1.Clear()
            End If
            'If textbox's text is still the same, notepad will open a new page:
        Else
            TextBox1.Clear()
        End If
    End Sub

    Private Sub OpenToolStripButton_Click(sender As Object, e As EventArgs) Handles OpenToolStripButton.Click
        'Check if there's text added to the textbox
        If TextBox1.Modified Then
            'If the text of notepad changed, the program will ask the user if they want to save the changes
            Dim ask As MsgBoxResult
            ask = MsgBox("Do you want to save the changes", MsgBoxStyle.YesNoCancel, "Open Document")
            If ask = MsgBoxResult.No Then
                OpenFileDialog1.ShowDialog()
                TextBox1.Text = My.Computer.FileSystem.ReadAllText(OpenFileDialog1.FileName)
            ElseIf ask = MsgBoxResult.Cancel Then
            ElseIf ask = MsgBoxResult.Yes Then
                SaveFileDialog1.ShowDialog()
                My.Computer.FileSystem.WriteAllText(SaveFileDialog1.FileName, TextBox1.Text, False)
                TextBox1.Clear()
            End If
        Else
            'If textbox's text is still the same, notepad will show the OpenFileDialog
            OpenFileDialog1.ShowDialog()
            Try
                TextBox1.Text = My.Computer.FileSystem.ReadAllText(OpenFileDialog1.FileName)
            Catch ex As Exception
            End Try
        End If
    End Sub
    Dim saveFile As New SaveFileDialog()
    Private Sub SaveToolStripButton_Click(sender As Object, e As EventArgs) Handles SaveToolStripButton.Click
        'this ones for a Save Button
        If (saveFile.FileName.Length) > 0 Then
            IO.File.WriteAllText(saveFile.FileName, TextBox1.Text)
        End If
    End Sub
    Private Sub CutToolStripButton_Click(sender As Object, e As EventArgs) Handles CutToolStripButton.Click
        My.Computer.Clipboard.Clear()
        If TextBox1.SelectionLength > 0 Then
            My.Computer.Clipboard.SetText(TextBox1.SelectedText)

        End If
        TextBox1.SelectedText = ""
    End Sub

    Private Sub CopyToolStripButton_Click(sender As Object, e As EventArgs) Handles CopyToolStripButton.Click
        My.Computer.Clipboard.Clear()
        If TextBox1.SelectionLength > 0 Then
        Else
            My.Computer.Clipboard.SetText(TextBox1.SelectedText)

        End If
    End Sub

    Private Sub PasteToolStripButton_Click(sender As Object, e As EventArgs) Handles PasteToolStripButton.Click
        If My.Computer.Clipboard.ContainsText Then
            TextBox1.Paste()
        End If
    End Sub

    Private Sub FontColorsToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles FontColorsToolStripMenuItem.Click
        ColorDialog1.ShowDialog()
        TextBox1.ForeColor = ColorDialog1.Color
    End Sub

    Private Sub FontsToolStripMenuItem1_Click(sender As Object, e As EventArgs) Handles FontsToolStripMenuItem1.Click
        FontDialog1.ShowDialog()
        TextBox1.Font = FontDialog1.Font
    End Sub

    Private Sub BoldToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles BoldToolStripMenuItem.Click
        If TextBox1.SelectionFont.Bold = True Then
            If TextBox1.SelectionFont.Italic = True Then
                TextBox1.SelectionFont = New Font(Me.TextBox1.SelectionFont, FontStyle.Regular + FontStyle.Italic)
            Else
                TextBox1.SelectionFont = New Font(Me.TextBox1.SelectionFont, FontStyle.Regular)
            End If

        ElseIf TextBox1.SelectionFont.Bold = False Then
            If TextBox1.SelectionFont.Italic = True Then
                TextBox1.SelectionFont = New Font(Me.TextBox1.SelectionFont, FontStyle.Bold + FontStyle.Italic)
            Else
                TextBox1.SelectionFont = New Font(Me.TextBox1.SelectionFont, FontStyle.Bold)
            End If
        End If
        TextBox1.Focus()
    End Sub

    Private Sub ItalicsToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles ItalicsToolStripMenuItem.Click
        If TextBox1.SelectionFont.Italic = True Then
            If TextBox1.SelectionFont.Bold = True Then
                TextBox1.SelectionFont = New Font(Me.TextBox1.SelectionFont, FontStyle.Regular + FontStyle.Bold)
            Else
                TextBox1.SelectionFont = New Font(Me.TextBox1.SelectionFont, FontStyle.Regular)
            End If

        ElseIf TextBox1.SelectionFont.Italic = False Then
            If TextBox1.SelectionFont.Bold = True Then
                TextBox1.SelectionFont = New Font(Me.TextBox1.SelectionFont, FontStyle.Italic + FontStyle.Bold)
            Else
                TextBox1.SelectionFont = New Font(Me.TextBox1.SelectionFont, FontStyle.Italic)
            End If
        End If
        TextBox1.Focus()
    End Sub

    Private Sub SaveAsToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles SaveAsToolStripMenuItem.Click
        SaveFileDialog1.ShowDialog()
        ' the application will check if the file is already exists, if exists, it will ask the user if they want to replace it
        If My.Computer.FileSystem.FileExists(SaveFileDialog1.FileName) Then
            Dim ask As MsgBoxResult
            ask = MsgBox("File already exists, would you like to replace it?", MsgBoxStyle.YesNo, "File Exists")
            'if the user decides not to replace the existing file
            If ask = MsgBoxResult.No Then
                SaveFileDialog1.ShowDialog()
                'if the user decides to replace the existing file
            ElseIf ask = MsgBoxResult.Yes Then
                My.Computer.FileSystem.WriteAllText(SaveFileDialog1.FileName, TextBox1.Text, False)
            End If
            'if the file doesn't exist
        Else
            Try
                My.Computer.FileSystem.WriteAllText(SaveFileDialog1.FileName, TextBox1.Text, False)
            Catch ex As Exception
            End Try
        End If
        If (saveFile.FileName.Length) > 0 Then
            IO.File.WriteAllText(saveFile.FileName, TextBox1.Text)
        End If
    End Sub

    Private Sub AboutToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles AboutToolStripMenuItem.Click
        MsgBox("This is built from a richtextbox for quality retro style documents that still are used today! This is a easy to use utility of BeffsBrowser! Version 0.1 Beta")
    End Sub

    Private Sub BeffsEasyNotes_FormClosing(sender As Object, e As FormClosingEventArgs) Handles MyBase.FormClosing
        'display message on form closing
        Dim Result As DialogResult
        Result = MessageBox.Show("Are you sure you wanna exit Any unsaved Progresss will be lost?", "Save your work before leaving!", MessageBoxButtons.YesNo)

        'if user clicked no, cancel form closing
        If Result = System.Windows.Forms.DialogResult.No Then
            e.Cancel = True
        End If
    End Sub

    Private Sub PrintToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles PrintToolStripMenuItem.Click
        Dim dialog As New PrintDialog
        dialog.ShowDialog()
    End Sub

    Private Sub PrintPreviewToolStripMenuItem_Click(sender As Object, e As EventArgs) Handles PrintPreviewToolStripMenuItem.Click

        Dim dialog As New PrintPreviewDialog
        dialog.ShowDialog()
    End Sub

  
    Private Sub PrintToolStripButton_Click(sender As Object, e As EventArgs) Handles PrintToolStripButton.Click
        Dim dialog As New PrintDialog
        dialog.ShowDialog()
    End Sub
End Class
